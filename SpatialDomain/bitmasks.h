#ifndef LB_INCLUDED_OCT_BIT_MASKS_HPP
#define LB_INCLUDED_OCT_BIT_MASKS_HPP

#include <stdint.h>
#include <array>

namespace octree
{


template<int Dim> struct Bitmasks { };

template<> struct Bitmasks<3>{

using id_t = std::uint_fast64_t;

static constexpr int max_level = 19;

//Note 0b indicates that the binary literal is used    
//The key bits are encoded as follows
//0--19*3-1=0--56 bit: coordinates
//57--61 bit: level
//61--63 bit: flags
//                                    --1--2--3--4--5--6--7--8--9-10-11-12-13-14-15-16-17-18-19--lev-- 
//                                    --|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|----|-|
static constexpr id_t level_mask    = 0b0000000000000000000000000000000000000000000000000000000001111100;
static constexpr id_t coord_mask    = 0b1111111111111111111111111111111111111111111111111111111110000000;
static constexpr id_t flag_mask     = 0b0000000000000000000000000000000000000000000000000000000000000011;
static constexpr id_t lo_mask       = 0b0000000000000000000000000000000000000000000000000000000000000001;
static constexpr id_t hi_mask       = 0b1000000000000000000000000000000000000000000000000000000000000000;
static constexpr id_t x_mask        = 0b0010010010010010010010010010010010010010010010010010010010000000;
static constexpr id_t y_mask        = 0b0100100100100100100100100100100100100100100100100100100100000000;
static constexpr id_t z_mask        = 0b1001001001001001001001001001001001001001001001001001001000000000;

static constexpr id_t min_0         = 0b0000000000000000000000000000000000000000000000000000000000000000;
static constexpr id_t min_1         = 0b0000000000000000000000000000000000000000000000000000000000000100;
static constexpr id_t min_2         = 0b0000000000000000000000000000000000000000000000000000000000001000;
static constexpr id_t min_3         = 0b0000000000000000000000000000000000000000000000000000000000001100;
static constexpr id_t min_4         = 0b0000000000000000000000000000000000000000000000000000000000010000;
static constexpr id_t min_5         = 0b0000000000000000000000000000000000000000000000000000000000010100;
static constexpr id_t min_6         = 0b0000000000000000000000000000000000000000000000000000000000011000;
static constexpr id_t min_7         = 0b0000000000000000000000000000000000000000000000000000000000011100;
static constexpr id_t min_8         = 0b0000000000000000000000000000000000000000000000000000000000100000;
static constexpr id_t min_9         = 0b0000000000000000000000000000000000000000000000000000000000100100;
static constexpr id_t min_10        = 0b0000000000000000000000000000000000000000000000000000000000101000;
static constexpr id_t min_11        = 0b0000000000000000000000000000000000000000000000000000000000101100;
static constexpr id_t min_12        = 0b0000000000000000000000000000000000000000000000000000000000110000;
static constexpr id_t min_13        = 0b0000000000000000000000000000000000000000000000000000000000110100;
static constexpr id_t min_14        = 0b0000000000000000000000000000000000000000000000000000000000111000;
static constexpr id_t min_15        = 0b0000000000000000000000000000000000000000000000000000000000111100;
static constexpr id_t min_16        = 0b0000000000000000000000000000000000000000000000000000000001000000;
static constexpr id_t min_17        = 0b0000000000000000000000000000000000000000000000000000000001000100;
static constexpr id_t min_18        = 0b0000000000000000000000000000000000000000000000000000000001001000;
static constexpr id_t min_19        = 0b0000000000000000000000000000000000000000000000000000000001001100;

static constexpr std::array<id_t,20> min_arr = {{
    min_0,  min_1,  min_2,  min_3,  min_4,
    min_5,  min_6,  min_7,  min_8,  min_9,
    min_10, min_11, min_12, min_13, min_14,
    min_15, min_16, min_17, min_18, min_19}};

static constexpr id_t max_0         = 0b0000000000000000000000000000000000000000000000000000000000000011;
static constexpr id_t max_1         = 0b1110000000000000000000000000000000000000000000000000000000000111;
static constexpr id_t max_2         = 0b1111110000000000000000000000000000000000000000000000000000001011;
static constexpr id_t max_3         = 0b1111111110000000000000000000000000000000000000000000000000001111;
static constexpr id_t max_4         = 0b1111111111110000000000000000000000000000000000000000000000010011;
static constexpr id_t max_5         = 0b1111111111111110000000000000000000000000000000000000000000010111;
static constexpr id_t max_6         = 0b1111111111111111110000000000000000000000000000000000000000011011;
static constexpr id_t max_7         = 0b1111111111111111111110000000000000000000000000000000000000011111;
static constexpr id_t max_8         = 0b1111111111111111111111110000000000000000000000000000000000100011;
static constexpr id_t max_9         = 0b1111111111111111111111111110000000000000000000000000000000100111;
static constexpr id_t max_10        = 0b1111111111111111111111111111110000000000000000000000000000101011;
static constexpr id_t max_11        = 0b1111111111111111111111111111111110000000000000000000000000101111;
static constexpr id_t max_12        = 0b1111111111111111111111111111111111110000000000000000000000110011;
static constexpr id_t max_13        = 0b1111111111111111111111111111111111111110000000000000000000110111;
static constexpr id_t max_14        = 0b1111111111111111111111111111111111111111110000000000000000111011;
static constexpr id_t max_15        = 0b1111111111111111111111111111111111111111111110000000000000111111;
static constexpr id_t max_16        = 0b1111111111111111111111111111111111111111111111110000000001000011;
static constexpr id_t max_17        = 0b1111111111111111111111111111111111111111111111111110000001000111;
static constexpr id_t max_18        = 0b1111111111111111111111111111111111111111111111111111110001001011;
static constexpr id_t max_19        = 0b1111111111111111111111111111111111111111111111111111111111001111;

static constexpr std::array<id_t,20> max_arr = {{
    max_0,  max_1,  max_2,  max_3,  max_4,
    max_5,  max_6,  max_7,  max_8,  max_9,
    max_10, max_11, max_12, max_13, max_14,
    max_15, max_16, max_17, max_18, max_19}};

static constexpr id_t coord_mask_0  = 0b0000000000000000000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_1  = 0b1110000000000000000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_2  = 0b1111110000000000000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_3  = 0b1111111110000000000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_4  = 0b1111111111110000000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_5  = 0b1111111111111110000000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_6  = 0b1111111111111111110000000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_7  = 0b1111111111111111111110000000000000000000000000000000000000000000;
static constexpr id_t coord_mask_8  = 0b1111111111111111111111110000000000000000000000000000000000000000;
static constexpr id_t coord_mask_9  = 0b1111111111111111111111111110000000000000000000000000000000000000;
static constexpr id_t coord_mask_10 = 0b1111111111111111111111111111110000000000000000000000000000000000;
static constexpr id_t coord_mask_11 = 0b1111111111111111111111111111111110000000000000000000000000000000;
static constexpr id_t coord_mask_12 = 0b1111111111111111111111111111111111110000000000000000000000000000;
static constexpr id_t coord_mask_13 = 0b1111111111111111111111111111111111111110000000000000000000000000;
static constexpr id_t coord_mask_14 = 0b1111111111111111111111111111111111111111110000000000000000000000;
static constexpr id_t coord_mask_15 = 0b1111111111111111111111111111111111111111111110000000000000000000;
static constexpr id_t coord_mask_16 = 0b1111111111111111111111111111111111111111111111110000000000000000;
static constexpr id_t coord_mask_17 = 0b1111111111111111111111111111111111111111111111111110000000000000;
static constexpr id_t coord_mask_18 = 0b1111111111111111111111111111111111111111111111111111110000000000;
static constexpr id_t coord_mask_19 = 0b1111111111111111111111111111111111111111111111111111111110000000;

static constexpr std::array<id_t,20> coord_mask_arr = {{
    coord_mask_0,  coord_mask_1,  coord_mask_2,  coord_mask_3,  coord_mask_4,
    coord_mask_5,  coord_mask_6,  coord_mask_7,  coord_mask_8,  coord_mask_9,
    coord_mask_10, coord_mask_11, coord_mask_12, coord_mask_13, coord_mask_14,
    coord_mask_15, coord_mask_16, coord_mask_17, coord_mask_18, coord_mask_19}};

static constexpr int size_0  =      1;
static constexpr int size_1  =      2;
static constexpr int size_2  =      4;
static constexpr int size_3  =      8;
static constexpr int size_4  =     16;
static constexpr int size_5  =     32;
static constexpr int size_6  =     64;
static constexpr int size_7  =    128;
static constexpr int size_8  =    256;
static constexpr int size_9  =    512;
static constexpr int size_10 =   1024;
static constexpr int size_11 =   2048;
static constexpr int size_12 =   4096;
static constexpr int size_13 =   8192;
static constexpr int size_14 =  16384;
static constexpr int size_15 =  32768;
static constexpr int size_16 =  65536;
static constexpr int size_17 = 131072;
static constexpr int size_18 = 262144;
static constexpr int size_19 = 524288;

static constexpr std::array<int,20> size_arr = {{
    size_0,  size_1,  size_2,  size_3,  size_4,
    size_5,  size_6,  size_7,  size_8,  size_9,
    size_10, size_11, size_12, size_13, size_14,
    size_15, size_16, size_17, size_18, size_19}};
}; 

constexpr decltype(Bitmasks<3>::min_arr)        Bitmasks<3>::min_arr;
constexpr decltype(Bitmasks<3>::max_arr)        Bitmasks<3>::max_arr;
constexpr decltype(Bitmasks<3>::coord_mask_arr) Bitmasks<3>::coord_mask_arr;
constexpr decltype(Bitmasks<3>::size_arr)       Bitmasks<3>::size_arr;

} // namespace octree

#endif // LB_INCLUDED_OCT_BIT_MASKS_HPP
